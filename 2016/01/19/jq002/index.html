<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="google-site-verification" content="eGNFdt2ztR4hEzEBjDkGQUWo0r_iPHpw1hoLqy-UUb0" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1" />
  <meta name="renderer" content="webkit">
  
  <title>jQuery源码学习--002工具函数 | 测试狗</title>
  <meta name="description" content="工具函数// 扩展工具函数jQuery.extend(&amp;#123;    // http://www.w3school.com.cn/jquery/core_noconflict.asp    // 释放$的 jQuery 控制权    // 许多 JavaScript 库使用 $ 作为函数或变量名，jQuery 也一样。    // 在 jQuery 中，$ 仅仅是 jQuery 的别名，因此即">
<meta name="keywords" content="jq源码学习,jquery源码">
<meta property="og:type" content="article">
<meta property="og:title" content="jQuery源码学习--002工具函数">
<meta property="og:url" content="http://thinkerchan.com/2016/01/19/jq002/index.html">
<meta property="og:site_name" content="测试狗">
<meta property="og:description" content="工具函数// 扩展工具函数jQuery.extend(&amp;#123;    // http://www.w3school.com.cn/jquery/core_noconflict.asp    // 释放$的 jQuery 控制权    // 许多 JavaScript 库使用 $ 作为函数或变量名，jQuery 也一样。    // 在 jQuery 中，$ 仅仅是 jQuery 的别名，因此即">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2016-01-19T02:03:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jQuery源码学习--002工具函数">
<meta name="twitter:description" content="工具函数// 扩展工具函数jQuery.extend(&amp;#123;    // http://www.w3school.com.cn/jquery/core_noconflict.asp    // 释放$的 jQuery 控制权    // 许多 JavaScript 库使用 $ 作为函数或变量名，jQuery 也一样。    // 在 jQuery 中，$ 仅仅是 jQuery 的别名，因此即">
<meta name="twitter:creator" content="@thinkerchan">
<meta property="fb:admins" content="thinkerchan">
  
  <link rel="alternate" href="/atom.xml" title="测试狗" type="application/rss+xml">
  

  <link rel="stylesheet" href="/css/style.css" >
  <link rel="shortcut icon" href="/images/favicon.png"/>
  <script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='https://unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
  <script data-main="/js/build" src="/js/require.js"></script>
  <!--[if lt IE 7]>
  <style>
    .section{
      width: 780px;
    }
    .post-content img{
      width: 100%;
    }
    .jupe pre{
      width: 100%;
    }
  </style>
  <![endif]-->
</head>
<body id="normal" >

<div class="section-wrap section-main">
	<div class="section">
		<div class="header">
	<h1 class="logo">
		<a href="/">测试狗</a>
	</h1>
	<p class="social-links hide">
		<!-- <a href="http://weibo.com/thinkerchank/" target="_blank">Weibo</a> -->
		/
		<!-- <a href="https://www.zhihu.com/people/fattychan/activities" target="_blank">Zhihu</a> -->
		/
		<!-- <a href="https://github.com/thinkerchan" target="_blank">Github</a> -->
	</p>
</div>
		<div class="main">
						<div class="jupe main-body">
				<div class="post-content">
					<h1 class="post-title">jQuery源码学习--002工具函数</h1>
					<div class="post-meta">
						<span class="post-time">2016.01.19</span>
						<div class="post-cats">
							<a class="post-cats-item-link" href="/categories/jQuery/">jQuery</a>
						</div>
					</div>
					<div class="post-toc">
						<div class="toc-title">TOC</div>
						<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#工具函数"><span class="toc-number">1.</span> <span class="toc-text">工具函数</span></a></li></ol>
					</div>
					<h2 id="工具函数"><a href="#工具函数" class="headerlink" title="工具函数"></a>工具函数</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 扩展工具函数</span></span><br><span class="line">jQuery.extend(&#123;</span><br><span class="line">    <span class="comment">// http://www.w3school.com.cn/jquery/core_noconflict.asp</span></span><br><span class="line">    <span class="comment">// 释放$的 jQuery 控制权</span></span><br><span class="line">    <span class="comment">// 许多 JavaScript 库使用 $ 作为函数或变量名，jQuery 也一样。</span></span><br><span class="line">    <span class="comment">// 在 jQuery 中，$ 仅仅是 jQuery 的别名，因此即使不使用 $ 也能保证所有功能性。</span></span><br><span class="line">    <span class="comment">// 假如我们需要使用 jQuery 之外的另一 JavaScript 库，我们可以通过调用 $.noConflict() 向该库返回控制权。</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过向该方法传递参数 true，我们可以将 $ 和 jQuery 的控制权都交还给另一JavaScript库。</span></span><br><span class="line">    noConflict: <span class="function"><span class="keyword">function</span>(<span class="params"> deep </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 交出$的控制权</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="built_in">window</span>.$ === jQuery ) &#123;</span><br><span class="line">           <span class="built_in">window</span>.$ = _$;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 交出jQuery的控制权</span></span><br><span class="line">       <span class="keyword">if</span> ( deep &amp;&amp; <span class="built_in">window</span>.jQuery === jQuery ) &#123;</span><br><span class="line">           <span class="built_in">window</span>.jQuery = _jQuery;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> jQuery;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is the DOM ready to be used? Set to true once it occurs.</span></span><br><span class="line">    isReady: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A counter to track how many items to wait for before</span></span><br><span class="line">    <span class="comment">// the ready event fires. See #6781</span></span><br><span class="line">    <span class="comment">// 一个计数器，用于跟踪在ready事件出发前的等待次数</span></span><br><span class="line">    readyWait: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Hold (or release) the ready event</span></span><br><span class="line">    <span class="comment">// 继续等待或触发</span></span><br><span class="line">    holdReady: <span class="function"><span class="keyword">function</span>(<span class="params"> hold </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> ( hold ) &#123;</span><br><span class="line">           jQuery.readyWait++;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           jQuery.ready( <span class="literal">true</span> );</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle when the DOM is ready</span></span><br><span class="line">    <span class="comment">// 文档加载完毕句柄</span></span><br><span class="line">    <span class="comment">// http://www.cnblogs.com/fjzhou/archive/2011/05/31/jquery-source-4.html</span></span><br><span class="line">    ready: <span class="function"><span class="keyword">function</span>(<span class="params"> wait </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// Either a released hold or an DOMready/load event and not yet ready</span></span><br><span class="line">       <span class="comment">//</span></span><br><span class="line">       <span class="keyword">if</span> ( (wait === <span class="literal">true</span> &amp;&amp; !--jQuery.readyWait) || (wait !== <span class="literal">true</span> &amp;&amp; !jQuery.isReady) ) &#123;</span><br><span class="line">           <span class="comment">// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).</span></span><br><span class="line">           <span class="comment">// 确保document.body存在</span></span><br><span class="line">           <span class="keyword">if</span> ( !<span class="built_in">document</span>.body ) &#123;</span><br><span class="line">              <span class="keyword">return</span> setTimeout( jQuery.ready, <span class="number">1</span> );</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="comment">// Remember that the DOM is ready</span></span><br><span class="line">           jQuery.isReady = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">           <span class="comment">// If a normal DOM Ready event fired, decrement, and wait if need be</span></span><br><span class="line">           <span class="keyword">if</span> ( wait !== <span class="literal">true</span> &amp;&amp; --jQuery.readyWait &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="comment">// If there are functions bound, to execute</span></span><br><span class="line">           readyList.resolveWith( <span class="built_in">document</span>, [ jQuery ] );</span><br><span class="line"></span><br><span class="line">           <span class="comment">// Trigger any bound ready events</span></span><br><span class="line">           <span class="keyword">if</span> ( jQuery.fn.trigger ) &#123;</span><br><span class="line">              jQuery( <span class="built_in">document</span> ).trigger( <span class="string">"ready"</span> ).unbind( <span class="string">"ready"</span> );</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化readyList事件处理函数队列</span></span><br><span class="line">    <span class="comment">// 兼容不同浏览对绑定事件的区别</span></span><br><span class="line">    bindReady: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> ( readyList ) &#123;</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       readyList = jQuery._Deferred();</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Catch cases where $(document).ready() is called after the</span></span><br><span class="line">       <span class="comment">// browser event has already occurred.</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="built_in">document</span>.readyState === <span class="string">"complete"</span> ) &#123;</span><br><span class="line">           <span class="comment">// Handle it asynchronously to allow scripts the opportunity to delay ready</span></span><br><span class="line">           <span class="keyword">return</span> setTimeout( jQuery.ready, <span class="number">1</span> );</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Mozilla, Opera and webkit nightlies currently support this event</span></span><br><span class="line">       <span class="comment">// 兼容事件，通过检测浏览器的功能特性，而非嗅探浏览器</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="built_in">document</span>.addEventListener ) &#123;</span><br><span class="line">           <span class="comment">// Use the handy event callback</span></span><br><span class="line">           <span class="comment">// 使用较快的加载完毕事件</span></span><br><span class="line">           <span class="built_in">document</span>.addEventListener( <span class="string">"DOMContentLoaded"</span>, DOMContentLoaded, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">           <span class="comment">// A fallback to window.onload, that will always work</span></span><br><span class="line">           <span class="comment">// 注册window.onload回调函数</span></span><br><span class="line">           <span class="built_in">window</span>.addEventListener( <span class="string">"load"</span>, jQuery.ready, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">       <span class="comment">// If IE event model is used</span></span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( <span class="built_in">document</span>.attachEvent ) &#123;</span><br><span class="line">           <span class="comment">// ensure firing before onload,</span></span><br><span class="line">           <span class="comment">// maybe late but safe also for iframes</span></span><br><span class="line">           <span class="comment">// 确保在onload之前触发onreadystatechange，可能慢一些但是对iframes更安全</span></span><br><span class="line">           <span class="built_in">document</span>.attachEvent( <span class="string">"onreadystatechange"</span>, DOMContentLoaded );</span><br><span class="line"></span><br><span class="line">           <span class="comment">// A fallback to window.onload, that will always work</span></span><br><span class="line">           <span class="comment">// 注册window.onload回调函数</span></span><br><span class="line">           <span class="built_in">window</span>.attachEvent( <span class="string">"onload"</span>, jQuery.ready );</span><br><span class="line"></span><br><span class="line">           <span class="comment">// If IE and not a frame</span></span><br><span class="line">           <span class="comment">// continually check to see if the document is ready</span></span><br><span class="line">           <span class="keyword">var</span> toplevel = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">              toplevel = <span class="built_in">window</span>.frameElement == <span class="literal">null</span>;</span><br><span class="line">           &#125; <span class="keyword">catch</span>(e) &#123;&#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> ( <span class="built_in">document</span>.documentElement.doScroll &amp;&amp; toplevel ) &#123;</span><br><span class="line">              doScrollCheck();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// See test/unit/core.js for details concerning isFunction.</span></span><br><span class="line">    <span class="comment">// Since version 1.3, DOM methods and functions like alert</span></span><br><span class="line">    <span class="comment">// aren't supported. They return false on IE (#2968).</span></span><br><span class="line">    <span class="comment">// 是否函数</span></span><br><span class="line">    isFunction: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> jQuery.type(obj) === <span class="string">"function"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否数组</span></span><br><span class="line">    <span class="comment">// 如果浏览器有内置的 Array.isArray 实现，就使用浏览器自身的实现方式，</span></span><br><span class="line">    <span class="comment">// 否则将对象转为String，看是否为"[object Array]"。</span></span><br><span class="line">    isArray: <span class="built_in">Array</span>.isArray || <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> jQuery.type(obj) === <span class="string">"array"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A crude way of determining if an object is a window</span></span><br><span class="line">    <span class="comment">// 简单的判断（判断setInterval属性）是否window对象</span></span><br><span class="line">    isWindow: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> obj &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">"object"</span> &amp;&amp; <span class="string">"setInterval"</span> <span class="keyword">in</span> obj;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否是保留字NaN</span></span><br><span class="line">    <span class="built_in">isNaN</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 等于null 或 不是数字 或调用window.isNaN判断</span></span><br><span class="line">       <span class="keyword">return</span> obj == <span class="literal">null</span> || !rdigit.test( obj ) || <span class="built_in">isNaN</span>( obj );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 获取对象的类型</span></span><br><span class="line">    type: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 通过核心API创建一个对象，不需要new关键字</span></span><br><span class="line">       <span class="comment">// 普通函数不行</span></span><br><span class="line">       <span class="comment">// 调用Object.prototype.toString方法，生成 "[object Xxx]"格式的字符串</span></span><br><span class="line">       <span class="comment">// class2type[ "[object " + name + "]" ] = name.toLowerCase();</span></span><br><span class="line">       <span class="keyword">return</span> obj == <span class="literal">null</span> ?</span><br><span class="line">           <span class="built_in">String</span>( obj ) :</span><br><span class="line">           class2type[ toString.call(obj) ] || <span class="string">"object"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查obj是否是一个纯粹的对象（通过"&#123;&#125;" 或 "new Object"创建的对象）</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( &#123;&#125; ) ); // true</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( '' ) ); // false</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( document.location ) ); // true</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( document ) ); // false</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( new Date() ) ); // false</span></span><br><span class="line">    <span class="comment">// console.info( $.isPlainObject( ) ); // false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// isPlainObject分析与重构 http://www.jb51.net/article/25047.htm</span></span><br><span class="line">    <span class="comment">// 对jQuery.isPlainObject()的理解 http://www.cnblogs.com/phpmix/articles/1733599.html</span></span><br><span class="line">    isPlainObject: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// Must be an Object.</span></span><br><span class="line">       <span class="comment">// Because of IE, we also have to check the presence of the constructor property.</span></span><br><span class="line">       <span class="comment">// Make sure that DOM nodes and window objects don't pass through, as well</span></span><br><span class="line">       <span class="comment">// 必须是一个对象</span></span><br><span class="line">       <span class="comment">// 因为在IE8中会抛出非法指针异常，必须检查constructor属性</span></span><br><span class="line">       <span class="comment">// DOM节点和window对象，返回false</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// obj不存在 或 非object类型 或 DOM节点 或 widnow对象，直接返回false</span></span><br><span class="line">       <span class="comment">// 测试以下三中可能的情况：</span></span><br><span class="line">       <span class="comment">// jQuery.type(obj) !== "object" 类型不是object，忽略</span></span><br><span class="line">       <span class="comment">// obj.nodeType 认为DOM节点不是纯对象</span></span><br><span class="line">       <span class="comment">// jQuery.isWindow( obj ) 认为window不是纯对象</span></span><br><span class="line">       <span class="keyword">if</span> ( !obj || jQuery.type(obj) !== <span class="string">"object"</span> || obj.nodeType || jQuery.isWindow( obj ) ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Not own constructor property must be Object</span></span><br><span class="line">       <span class="comment">// 测试constructor属性</span></span><br><span class="line">       <span class="comment">// 具有构造函数constructor，却不是自身的属性（即通过prototype继承的），</span></span><br><span class="line">       <span class="keyword">if</span> ( obj.constructor &amp;&amp;</span><br><span class="line">           !hasOwn.call(obj, <span class="string">"constructor"</span>) &amp;&amp;</span><br><span class="line">           !hasOwn.call(obj.constructor.prototype, <span class="string">"isPrototypeOf"</span>) ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Own properties are enumerated firstly, so to speed up,</span></span><br><span class="line">       <span class="comment">// if last one is own, then all properties are own.</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">var</span> key;</span><br><span class="line">       <span class="keyword">for</span> ( key <span class="keyword">in</span> obj ) &#123;&#125;</span><br><span class="line">       <span class="comment">// key === undefined及不存在任何属性，认为是简单的纯对象</span></span><br><span class="line">       <span class="comment">// hasOwn.call( obj, key ) 属性key不为空，且属性key的对象自身的（即不是通过prototype继承的）</span></span><br><span class="line">       <span class="keyword">return</span> key === <span class="literal">undefined</span> || hasOwn.call( obj, key );</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 是否空对象</span></span><br><span class="line">    isEmptyObject: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">for</span> ( <span class="keyword">var</span> name <span class="keyword">in</span> obj ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 抛出一个异常</span></span><br><span class="line">    error: <span class="function"><span class="keyword">function</span>(<span class="params"> msg </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">throw</span> msg;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 解析JSON</span></span><br><span class="line">    <span class="comment">// parseJSON把一个字符串变成JSON对象。</span></span><br><span class="line">    <span class="comment">// 我们一般使用的是eval。parseJSON封装了这个操作，但是eval被当作了最后手段。</span></span><br><span class="line">    <span class="comment">// 因为最新JavaScript标准中加入了JSON序列化和反序列化的API。</span></span><br><span class="line">    <span class="comment">// 如果浏览器支持这个标准，则这两个API是在JS引擎中用Native Code实现的，效率肯定比eval高很多。</span></span><br><span class="line">    <span class="comment">// 目前来看，Chrome和Firefox4都支持这个API。</span></span><br><span class="line">    parseJSON: <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> ( <span class="keyword">typeof</span> data !== <span class="string">"string"</span> || !data ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Make sure leading/trailing whitespace is removed (IE can't handle it)</span></span><br><span class="line">       data = jQuery.trim( data );</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Attempt to parse using the native JSON parser first</span></span><br><span class="line">       <span class="comment">// 原生JSON API。反序列化是JSON.stringify(object)</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="built_in">window</span>.JSON &amp;&amp; <span class="built_in">window</span>.JSON.parse ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="built_in">window</span>.JSON.parse( data );</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Make sure the incoming data is actual JSON</span></span><br><span class="line">       <span class="comment">// Logic borrowed from http://json.org/json2.js</span></span><br><span class="line">       <span class="comment">// ... 大致地检查一下字符串合法性</span></span><br><span class="line">       <span class="keyword">if</span> ( rvalidchars.test( data.replace( rvalidescape, <span class="string">"@"</span> )</span><br><span class="line">           .replace( rvalidtokens, <span class="string">"]"</span> )</span><br><span class="line">           .replace( rvalidbraces, <span class="string">""</span>)) ) &#123;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> (<span class="keyword">new</span> <span class="built_in">Function</span>( <span class="string">"return "</span> + data ))();</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line">       jQuery.error( <span class="string">"Invalid JSON: "</span> + data );</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cross-browser xml parsing</span></span><br><span class="line">    <span class="comment">// (xml &amp; tmp used internally)</span></span><br><span class="line">    <span class="comment">// 解析XML 跨浏览器</span></span><br><span class="line">    <span class="comment">// parseXML函数也主要是标准API和IE的封装。</span></span><br><span class="line">    <span class="comment">// 标准API是DOMParser对象。</span></span><br><span class="line">    <span class="comment">// 而IE使用的是Microsoft.XMLDOM的 ActiveXObject对象。</span></span><br><span class="line">    parseXML: <span class="function"><span class="keyword">function</span>(<span class="params"> data , xml , tmp </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> ( <span class="built_in">window</span>.DOMParser ) &#123; <span class="comment">// Standard 标准XML解析器</span></span><br><span class="line">           tmp = <span class="keyword">new</span> DOMParser();</span><br><span class="line">           xml = tmp.parseFromString( data , <span class="string">"text/xml"</span> );</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123; <span class="comment">// IE IE的XML解析器</span></span><br><span class="line">           xml = <span class="keyword">new</span> ActiveXObject( <span class="string">"Microsoft.XMLDOM"</span> );</span><br><span class="line">           xml.async = <span class="string">"false"</span>;</span><br><span class="line">           xml.loadXML( data );</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       tmp = xml.documentElement;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> ( ! tmp || ! tmp.nodeName || tmp.nodeName === <span class="string">"parsererror"</span> ) &#123;</span><br><span class="line">           jQuery.error( <span class="string">"Invalid XML: "</span> + data );</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> xml;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 无操作函数</span></span><br><span class="line">    noop: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Evaluates a script in a global context</span></span><br><span class="line">    <span class="comment">// Workarounds based on findings by Jim Driscoll</span></span><br><span class="line">    <span class="comment">// http://weblogs.java.net/blog/driscoll/archive/2009/09/08/eval-javascript-global-context</span></span><br><span class="line">    <span class="comment">// globalEval函数把一段脚本加载到全局context（window）中。</span></span><br><span class="line">    <span class="comment">// IE中可以使用window.execScript。</span></span><br><span class="line">    <span class="comment">// 其他浏览器 需要使用eval。</span></span><br><span class="line">    <span class="comment">// 因为整个jQuery代码都是一整个匿名函数，所以当前context是jQuery，如果要将上下文设置为window则需使用globalEval。</span></span><br><span class="line">    globalEval: <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// data非空</span></span><br><span class="line">       <span class="keyword">if</span> ( data &amp;&amp; rnotwhite.test( data ) ) &#123;</span><br><span class="line">           <span class="comment">// We use execScript on Internet Explorer</span></span><br><span class="line">           <span class="comment">// We use an anonymous function so that context is window</span></span><br><span class="line">           <span class="comment">// rather than jQuery in Firefox</span></span><br><span class="line">           ( <span class="built_in">window</span>.execScript || <span class="function"><span class="keyword">function</span>(<span class="params"> data </span>) </span>&#123;</span><br><span class="line">              <span class="built_in">window</span>[ <span class="string">"eval"</span> ].call( <span class="built_in">window</span>, data );</span><br><span class="line">           &#125; )( data );</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 判断节点名称是否相同</span></span><br><span class="line">    nodeName: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, name </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 忽略大小写</span></span><br><span class="line">       <span class="keyword">return</span> elem.nodeName &amp;&amp; elem.nodeName.toUpperCase() === name.toUpperCase();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// args is for internal usage only</span></span><br><span class="line">    <span class="comment">// 遍历对象或数组</span></span><br><span class="line">    each: <span class="function"><span class="keyword">function</span>(<span class="params"> object, callback, args </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> name, i = <span class="number">0</span>,</span><br><span class="line">           length = object.length,</span><br><span class="line">           isObj = length === <span class="literal">undefined</span> || jQuery.isFunction( object );</span><br><span class="line">       <span class="comment">// 如果有参数args，调用apply，上下文设置为当前遍历到的对象，参数使用args</span></span><br><span class="line">       <span class="keyword">if</span> ( args ) &#123;</span><br><span class="line">           <span class="keyword">if</span> ( isObj ) &#123;</span><br><span class="line">              <span class="keyword">for</span> ( name <span class="keyword">in</span> object ) &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( callback.apply( object[ name ], args ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">for</span> ( ; i &lt; length; ) &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( callback.apply( object[ i++ ], args ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// A special, fast, case for the most common use of each</span></span><br><span class="line">       <span class="comment">// 没有参数args则调用，则调用call，上下文设置为当前遍历到的对象，参数设置为key/index和value</span></span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> ( isObj ) &#123;</span><br><span class="line">              <span class="keyword">for</span> ( name <span class="keyword">in</span> object ) &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( callback.call( object[ name ], name, object[ name ] ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">for</span> ( ; i &lt; length; ) &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( callback.call( object[ i ], i, object[ i++ ] ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> object;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Use native String.trim function wherever possible</span></span><br><span class="line">    <span class="comment">// 尽可能的使用本地String.trim方法，否则先过滤开头的空格，再过滤结尾的空格</span></span><br><span class="line">    trim: trim ?</span><br><span class="line">       <span class="function"><span class="keyword">function</span>(<span class="params"> text </span>) </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> text == <span class="literal">null</span> ?</span><br><span class="line">              <span class="string">""</span> :</span><br><span class="line">              trim.call( text );</span><br><span class="line">       &#125; :</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Otherwise use our own trimming functionality</span></span><br><span class="line">       <span class="function"><span class="keyword">function</span>(<span class="params"> text </span>) </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> text == <span class="literal">null</span> ?</span><br><span class="line">              <span class="string">""</span> :</span><br><span class="line">              text.toString().replace( trimLeft, <span class="string">""</span> ).replace( trimRight, <span class="string">""</span> );</span><br><span class="line">       &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// results is for internal usage only</span></span><br><span class="line">    <span class="comment">// 将伪数组转换为数组</span></span><br><span class="line">    makeArray: <span class="function"><span class="keyword">function</span>(<span class="params"> array, results </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> ret = results || [];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> ( array != <span class="literal">null</span> ) &#123;</span><br><span class="line">           <span class="comment">// The window, strings (and functions) also have 'length'</span></span><br><span class="line">           <span class="comment">// The extra typeof function check is to prevent crashes</span></span><br><span class="line">           <span class="comment">// in Safari 2 (See: #3039)</span></span><br><span class="line">           <span class="comment">// Tweaked logic slightly to handle Blackberry 4.7 RegExp issues #6930</span></span><br><span class="line">           <span class="comment">// 一大堆浏览器兼容性测试，真实蛋疼</span></span><br><span class="line">           <span class="keyword">var</span> type = jQuery.type( array );</span><br><span class="line">           <span class="comment">// 测试：有没有length属性、字符串、函数、正则</span></span><br><span class="line">           <span class="comment">// 不是数组，连伪数组都不是</span></span><br><span class="line">           <span class="keyword">if</span> ( array.length == <span class="literal">null</span></span><br><span class="line">                  || type === <span class="string">"string"</span></span><br><span class="line">                  || type === <span class="string">"function"</span></span><br><span class="line">                  || type === <span class="string">"regexp"</span></span><br><span class="line">                  || jQuery.isWindow( array ) ) &#123;</span><br><span class="line">              push.call( ret, array );</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// $.type( $('div') ) // object</span></span><br><span class="line">              jQuery.merge( ret, array );</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    inArray: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, array </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 是否有本地化的Array.prototype.indexOf</span></span><br><span class="line">       <span class="keyword">if</span> ( indexOf ) &#123;</span><br><span class="line">           <span class="comment">// 直接调用Array.prototype.indexOf</span></span><br><span class="line">           <span class="keyword">return</span> indexOf.call( array, elem );</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 遍历数组，查找是否有完全相等的元素，并返回下标</span></span><br><span class="line">       <span class="comment">// 循环的小技巧：把array.length存放到length变量中，可以减少一次作用域查找</span></span><br><span class="line">       <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, length = array.length; i &lt; length; i++ ) &#123;</span><br><span class="line">           <span class="keyword">if</span> ( array[ i ] === elem ) &#123;</span><br><span class="line">              <span class="keyword">return</span> i;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 如果返回-1，则表示不在数组中</span></span><br><span class="line">       <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 将数组second合并到数组first中</span></span><br><span class="line">    merge: <span class="function"><span class="keyword">function</span>(<span class="params"> first, second </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> i = first.length, <span class="comment">//</span></span><br><span class="line">           j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 如果second的length属性是Number类型，则把second当数组处理</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="keyword">typeof</span> second.length === <span class="string">"number"</span> ) &#123;</span><br><span class="line">           <span class="keyword">for</span> ( <span class="keyword">var</span> l = second.length; j &lt; l; j++ ) &#123;</span><br><span class="line">              first[ i++ ] = second[ j ];</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="comment">// 遍历second，将非undefined的值添加到first中</span></span><br><span class="line">           <span class="keyword">while</span> ( second[j] !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">              first[ i++ ] = second[ j++ ];</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 修正first的length属性，因为first可能不是真正的数组</span></span><br><span class="line">        first.length = i;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> first;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 过滤数组，返回新数组；callback返回true时保留；如果inv为true，callback返回false才会保留</span></span><br><span class="line">    grep: <span class="function"><span class="keyword">function</span>(<span class="params"> elems, callback, inv </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> ret = [], retVal;</span><br><span class="line">       inv = !!inv;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Go through the array, only saving the items</span></span><br><span class="line">       <span class="comment">// that pass the validator function</span></span><br><span class="line">       <span class="comment">// 遍历数组，只保留通过验证函数callback的元素</span></span><br><span class="line">       <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, length = elems.length; i &lt; length; i++ ) &#123;</span><br><span class="line">           <span class="comment">// 这里callback的参数列表为：value, index，与each的习惯一致</span></span><br><span class="line">           retVal = !!callback( elems[ i ], i );</span><br><span class="line">           <span class="comment">// 是否反向选择</span></span><br><span class="line">           <span class="keyword">if</span> ( inv !== retVal ) &#123;</span><br><span class="line">              ret.push( elems[ i ] );</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// arg is for internal usage only</span></span><br><span class="line">    <span class="comment">// 将数组或对象elems的元素/属性，转化成新的数组</span></span><br><span class="line">    map: <span class="function"><span class="keyword">function</span>(<span class="params"> elems, callback, arg </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> value, key, ret = [],</span><br><span class="line">           i = <span class="number">0</span>,</span><br><span class="line">           length = elems.length,</span><br><span class="line">           <span class="comment">// jquery objects are treated as arrays</span></span><br><span class="line">           <span class="comment">// 检测elems是否是（伪）数组</span></span><br><span class="line">           <span class="comment">// 1. 将jQuery对象也当成数组处理</span></span><br><span class="line">           <span class="comment">// 2. 检测length属性是否存在，length等于0，或第一个和最后一个元素是否存在，或jQuery.isArray返回true</span></span><br><span class="line">           isArray = elems <span class="keyword">instanceof</span> jQuery</span><br><span class="line">              || length !== <span class="literal">undefined</span> &amp;&amp; <span class="keyword">typeof</span> length === <span class="string">"number"</span></span><br><span class="line">                  &amp;&amp; ( ( length &gt; <span class="number">0</span> &amp;&amp; elems[ <span class="number">0</span> ] &amp;&amp; elems[ length <span class="number">-1</span> ] ) || length === <span class="number">0</span> || jQuery.isArray( elems ) ) ;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 是数组或对象的差别，仅仅是遍历的方式不同，没有其他的区别</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">// Go through the array, translating each of the items to their</span></span><br><span class="line">       <span class="comment">// 遍历数组，对每一个元素调用callback，将返回值不为null的值，存入ret</span></span><br><span class="line">       <span class="keyword">if</span> ( isArray ) &#123;</span><br><span class="line">           <span class="keyword">for</span> ( ; i &lt; length; i++ ) &#123;</span><br><span class="line">              <span class="comment">// 执行callback，参数依次为value, index, arg</span></span><br><span class="line">              value = callback( elems[ i ], i, arg );</span><br><span class="line">              <span class="comment">// 如果返回null，则忽略（无返回值的function会返回undefined）</span></span><br><span class="line">              <span class="keyword">if</span> ( value != <span class="literal">null</span> ) &#123;</span><br><span class="line">                  ret[ ret.length ] = value;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Go through every key on the object,</span></span><br><span class="line">       <span class="comment">// 遍历对象，对每一个属性调用callback，将返回值不为null的值，存入ret</span></span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="keyword">for</span> ( key <span class="keyword">in</span> elems ) &#123;</span><br><span class="line">              <span class="comment">// 执行callback，参数依次为value, key, arg</span></span><br><span class="line">              value = callback( elems[ key ], key, arg );</span><br><span class="line">              <span class="comment">// 同上</span></span><br><span class="line">              <span class="keyword">if</span> ( value != <span class="literal">null</span> ) &#123;</span><br><span class="line">                  ret[ ret.length ] = value;</span><br><span class="line">              &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Flatten any nested arrays</span></span><br><span class="line">       <span class="comment">// 使嵌套数组变平</span></span><br><span class="line">       <span class="comment">// concat：</span></span><br><span class="line">       <span class="comment">// 如果某一项为数组，那么添加其内容到末尾。</span></span><br><span class="line">       <span class="comment">// 如果该项目不是数组，就将其作为单个的数组元素添加到数组的末尾。</span></span><br><span class="line">       <span class="keyword">return</span> ret.concat.apply( [], ret );</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A global GUID counter for objects</span></span><br><span class="line">    guid: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Bind a function to a context, optionally partially applying any</span></span><br><span class="line">    <span class="comment">// arguments.</span></span><br><span class="line">    <span class="comment">// 代理方法：为fn指定上下文（即this）</span></span><br><span class="line">    <span class="comment">// jQuery.proxy( function, context )</span></span><br><span class="line">    <span class="comment">// jQuery.proxy( context, name )</span></span><br><span class="line">    proxy: <span class="function"><span class="keyword">function</span>(<span class="params"> fn, context </span>) </span>&#123;</span><br><span class="line">       <span class="comment">// 如果context是字符串，设置上下文为fn，fn为fn[ context ]</span></span><br><span class="line">       <span class="comment">// 即设置fn的context方法的上下文为fn（默认不是这样吗？？？TODO）</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="keyword">typeof</span> context === <span class="string">"string"</span> ) &#123;</span><br><span class="line">           <span class="keyword">var</span> tmp = fn[ context ];</span><br><span class="line">           context = fn;</span><br><span class="line">           fn = tmp;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Quick check to determine if target is callable, in the spec</span></span><br><span class="line">       <span class="comment">// this throws a TypeError, but we will just return undefined.</span></span><br><span class="line">       <span class="comment">// 快速测试fn是否是可调用的（即函数），在文档说明中，会抛出一个TypeError，</span></span><br><span class="line">       <span class="comment">// 但是这里仅返回undefined</span></span><br><span class="line">       <span class="keyword">if</span> ( !jQuery.isFunction( fn ) ) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Simulated bind</span></span><br><span class="line">       <span class="keyword">var</span> args = slice.call( <span class="built_in">arguments</span>, <span class="number">2</span> ), <span class="comment">// 从参数列表中去掉fn,context</span></span><br><span class="line">           proxy = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">              <span class="comment">// 设置上下文为context和参数</span></span><br><span class="line">              <span class="keyword">return</span> fn.apply( context, args.concat( slice.call( <span class="built_in">arguments</span> ) ) );</span><br><span class="line">           &#125;;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Set the guid of unique handler to the same of original handler, so it can be removed</span></span><br><span class="line">       <span class="comment">// 统一guid，使得proxy能够被移除</span></span><br><span class="line">       proxy.guid = fn.guid = fn.guid || proxy.guid || jQuery.guid++;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Mutifunctional method to get and set values to a collection</span></span><br><span class="line">    <span class="comment">// The value/s can be optionally by executed if its a function</span></span><br><span class="line">    <span class="comment">// 多功能函数，读取或设置集合的属性值；值为函数时会被执行</span></span><br><span class="line">    <span class="comment">// fn：jQuery.fn.css, jQuery.fn.attr, jQuery.fn.prop</span></span><br><span class="line">    access: <span class="function"><span class="keyword">function</span>(<span class="params"> elems, key, value, exec, fn, pass </span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> length = elems.length;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Setting many attributes</span></span><br><span class="line">       <span class="comment">// 如果有多个属性，则迭代</span></span><br><span class="line">       <span class="keyword">if</span> ( <span class="keyword">typeof</span> key === <span class="string">"object"</span> ) &#123;</span><br><span class="line">           <span class="keyword">for</span> ( <span class="keyword">var</span> k <span class="keyword">in</span> key ) &#123;</span><br><span class="line">              jQuery.access( elems, k, key[k], exec, fn, value );</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> elems;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Setting one attribute</span></span><br><span class="line">       <span class="comment">// 只设置一个属性</span></span><br><span class="line">       <span class="keyword">if</span> ( value !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">           <span class="comment">// Optionally, function values get executed if exec is true</span></span><br><span class="line">           exec = !pass &amp;&amp; exec &amp;&amp; jQuery.isFunction(value);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++ ) &#123;</span><br><span class="line">              fn( elems[i], key, exec ? value.call( elems[i], i, fn( elems[i], key ) ) : value, pass );</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> elems;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Getting an attribute</span></span><br><span class="line">       <span class="comment">// 读取属性</span></span><br><span class="line">       <span class="keyword">return</span> length ? fn( elems[<span class="number">0</span>], key ) : <span class="literal">undefined</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 获取当前时间的便捷函数</span></span><br><span class="line">    now: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> (<span class="keyword">new</span> <span class="built_in">Date</span>()).getTime();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Use of jQuery.browser is frowned upon.</span></span><br><span class="line">    <span class="comment">// More details: http://docs.jquery.com/Utilities/jQuery.browser</span></span><br><span class="line">    <span class="comment">// 不赞成使用jQuery.browser，推荐使用jQuery.support</span></span><br><span class="line">    <span class="comment">// Navigator 正在使用的浏览器的信息</span></span><br><span class="line">    <span class="comment">// Navigator.userAgent 一个只读的字符串，声明了浏览器用于HTPP请求的用户代理头的值</span></span><br><span class="line">    uaMatch: <span class="function"><span class="keyword">function</span>(<span class="params"> ua </span>) </span>&#123;</span><br><span class="line">       ua = ua.toLowerCase();</span><br><span class="line">       <span class="comment">// 依次匹配各浏览器</span></span><br><span class="line">       <span class="keyword">var</span> match = rwebkit.exec( ua ) ||</span><br><span class="line">           ropera.exec( ua ) ||</span><br><span class="line">           rmsie.exec( ua ) ||</span><br><span class="line">           ua.indexOf(<span class="string">"compatible"</span>) &lt; <span class="number">0</span> &amp;&amp; rmozilla.exec( ua ) ||</span><br><span class="line">           [];</span><br><span class="line">       <span class="comment">// match[1] || ""</span></span><br><span class="line">       <span class="comment">// match[1]为false（空字符串、null、undefined、0等）时，默认为""</span></span><br><span class="line">       <span class="comment">// match[2] || "0"</span></span><br><span class="line">       <span class="comment">// match[2]为false（空字符串、null、undefined、0等）时，默认为"0"</span></span><br><span class="line">       <span class="keyword">return</span> &#123; <span class="attr">browser</span>: match[<span class="number">1</span>] || <span class="string">""</span>, <span class="attr">version</span>: match[<span class="number">2</span>] || <span class="string">"0"</span> &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 创建一个新的jQuery副本，副本的属性和方法可以被改变，但是不会影响原始的jQuery对象</span></span><br><span class="line">    <span class="comment">// 有两种用法：</span></span><br><span class="line">    <span class="comment">// 1. 覆盖jQuery的方法，而不破坏原始的方法</span></span><br><span class="line">    <span class="comment">// 2.封装，避免命名空间冲突，可以用来开发jQuery插件</span></span><br><span class="line">    <span class="comment">// 值得注意的是，jQuery.sub()函数并不提供真正的隔离，所有的属性、方法依然指向原始的jQuery</span></span><br><span class="line">    <span class="comment">// 如果使用这个方法来开发插件，建议优先考虑jQuery UI widget工程</span></span><br><span class="line">    sub: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="function"><span class="keyword">function</span> <span class="title">jQuerySub</span>(<span class="params"> selector, context </span>) </span>&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">new</span> jQuerySub.fn.init( selector, context );</span><br><span class="line">       &#125;</span><br><span class="line">       jQuery.extend( <span class="literal">true</span>, jQuerySub, <span class="keyword">this</span> ); <span class="comment">// 深度拷贝，将jQuery的所有属性和方法拷贝到jQuerySub</span></span><br><span class="line">       jQuerySub.superclass = <span class="keyword">this</span>;</span><br><span class="line">       jQuerySub.fn = jQuerySub.prototype = <span class="keyword">this</span>(); <span class="comment">//</span></span><br><span class="line">       jQuerySub.fn.constructor = jQuerySub;</span><br><span class="line">       jQuerySub.sub = <span class="keyword">this</span>.sub;</span><br><span class="line">       jQuerySub.fn.init = <span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"> selector, context </span>) </span>&#123;</span><br><span class="line">           <span class="keyword">if</span> ( context &amp;&amp; context <span class="keyword">instanceof</span> jQuery &amp;&amp; !(context <span class="keyword">instanceof</span> jQuerySub) ) &#123;</span><br><span class="line">              context = jQuerySub( context );</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> jQuery.fn.init.call( <span class="keyword">this</span>, selector, context, rootjQuerySub );</span><br><span class="line">       &#125;;</span><br><span class="line">       jQuerySub.fn.init.prototype = jQuerySub.fn;</span><br><span class="line">       <span class="keyword">var</span> rootjQuerySub = jQuerySub(<span class="built_in">document</span>);</span><br><span class="line">       <span class="keyword">return</span> jQuerySub;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 浏览器类型和版本：</span></span><br><span class="line">    <span class="comment">// $.browser.msie/mozilla/webkit/opera</span></span><br><span class="line">    <span class="comment">// $.browser.version</span></span><br><span class="line">    <span class="comment">// 不推荐嗅探浏览器类型jQuery.browser，而是检查浏览器的功能特性jQuery.support</span></span><br><span class="line">    <span class="comment">// 未来jQuery.browser可能会移到一个插件中</span></span><br><span class="line">    browser: &#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

					<div class="post-share">
	<ul class="share-list">
		<li><a class="icon icon-weibo" href="javascript:share.weibo();"><span>weibo</span></a></li>
		<li>
      <a class="icon icon-wechat" onmouseenter="share.wechat(this)"  onmouseleave="share.wechatHide()">
        <div class="wechat-qrcode" id="qrcodeBox">
          <img width="140" height="140" class="wechat-qrcode-img" id="wechatQrcodeImg">
          <em class="wechat-tri"></em>
        </div>
        <span>wechat</span>
      </a>
    </li>
		<li><a class="icon icon-qzone" href="javascript:share.qzone();"><span>qzone</span></a></li>
	</ul>
</div>
					<!-- 评论 -->
					<div class="post-comments" id="Jcmt">
	<h3 class="post-comments-tit">访客评论</h3>
	<div id="vcomments"></div>
	<script>

		var checkEle =function(id){return !!document.getElementById(id)} ,
			hideCmt = checkEle('JnoCmt')||checkEle('resume') ;
		if (hideCmt) {
			Jcmt.style.display = 'none';
		}else{
			new Valine({
			    el: '#vcomments',
			    appId: 'XPJzs0FfufkFfuBjbJraqhbo-gzGzoHsz',
			    appKey: 'QoS0zL4Y2xTDviitGOPkvCGv',
			    notify:false,
			    verify:false,
			    avatar:'mm',
			    placeholder: '感谢您的留言, 请勿灌水和广告.'
			})
		}
	</script>
</div>
				</div>
			</div>		</div>
		<div class="footer">
  <p class="left">&copy; Thinker Chan ,
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">
      本站总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
  </p>
	<p class="right">Hosted by <a href="https://pages.coding.me">Coding Pages</a>
  </p>
</div>
<div class="count" style="display: none;">
  <script type="text/javascript" src="https://s5.cnzz.com/z_stat.php?id=1276809529&web_id=1276809529"></script>
</div>
	</div>
</div>

</body>
</html>