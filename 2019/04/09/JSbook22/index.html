<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://thinkerchan.com">
  
  <title>JSçº¢çš®ä¹¦è¯»ä¹¦ç¬”è®°-22-é«˜çº§æŠ€å·§ | æµ‹è¯•ç‹—</title>
  <meta name="author" content="æµ‹è¯•ç‹—">
  
  <meta name="description" content="ğŸ¶">
  
  
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

  <meta property="og:title" content="JSçº¢çš®ä¹¦è¯»ä¹¦ç¬”è®°-22-é«˜çº§æŠ€å·§"/>
  <meta property="og:site_name" content="æµ‹è¯•ç‹—"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="alternate" href="/atom.xml" title="æµ‹è¯•ç‹—" type="application/atom+xml">

  <link rel="preload" as="style" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg">
  <link href="https://unpkg.com" rel="dns-prefetch" />
  <link href="https://busuanzi.ibruce.info" rel="dns-prefetch" />
  <link href="https://cdn1.lncld.net" rel="dns-prefetch" />
  
  <link href="https://xpjzs0ff.api.lncld.net" rel="dns-prefetch" />
  
</head>

<body>
  <div class="container">
    <div class="left-col" style="background-image:url('https://tva1.sinaimg.cn/large/007S8ZIlly1giq5k8ty3tj306y0zkdix.jpg')">
      <div class="intrude-less">
        <header id="header" class="inner">
          <a href="/">
            <div class="profilepic"><img class="avatar" src='https://tva1.sinaimg.cn/large/007S8ZIlly1giq5t0agwnj30bf0b4jrk.jpg'></div>
          </a>
          <div class="author-name"><a href="/">æµ‹è¯•ç‹—</a></div>
          <p class="aboutme">ğŸ¶</p>
          <nav id="main-nav">
            <ul class="main">
              
              <li>
                
                  <a href="/archives">å½’æ¡£</a>
                
              </li>
              
              <li>
                
                  <a href="/categories">ä¸“é¢˜</a>
                
              </li>
              
              <li>
                
                  <a href="/friendlinks">å‹é“¾</a>
                
              </li>
              
              <li>
                
                  <a href="/life">å…³äº</a>
                
              </li>
              
              <li>
                
                  <a href="/search">æœç´¢</a>
                
              </li>
              
            </ul>
          </nav>
          <nav id="sub-nav">
            <div class="social">
              
              <a class="twitter" href="https://twitter.com/thinkerchan" title="Twitter">Twitter</a>
              
              
              
              <a class="github" href="https://github.com/thinkerchan" title="Github">Github</a>
              
              
              <a class="yuque" href="https://yuque.com/testdog" title="è¯­é›€">è¯­é›€</a>
              

              
              <a class="rss" href="/atom.xml" title="RSS">RSS</a>
              
            </div>
          </nav>
        </header>
      </div>
    </div>
    <div class="mid-col">
      <div class="mid-col-container">
        <div id="content" class="inner">
          <article class="post">

  
    <div class="meta">
      
<div class="date">

<time datetime="2019-04-09T08:07:00.000Z"
      
      data-updated="true"
       itemprop="datePublished">
  2019-04-09
</time>





</div>

    </div>
  
  <h1 class="title" itemprop="name">JSçº¢çš®ä¹¦è¯»ä¹¦ç¬”è®°-22-é«˜çº§æŠ€å·§</h1>
  <div class="entry-content" itemprop="articleBody">
    
    <div class="post-toc">
      <div class="toc-title">TOC</div>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#é«˜çº§å‡½æ•°"><span class="toc-number">1.</span> <span class="toc-text">é«˜çº§å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å®‰å…¨ç±»å‹çš„æ£€æµ‹"><span class="toc-number">1.1.</span> <span class="toc-text">å®‰å…¨ç±»å‹çš„æ£€æµ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°"><span class="toc-number">1.2.</span> <span class="toc-text">ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æƒ°æ€§è½½å…¥å‡½æ•°"><span class="toc-number">1.3.</span> <span class="toc-text">æƒ°æ€§è½½å…¥å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‡½æ•°ç»‘å®š"><span class="toc-number">1.4.</span> <span class="toc-text">å‡½æ•°ç»‘å®š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‡½æ•°curryåŒ–"><span class="toc-number">1.5.</span> <span class="toc-text">å‡½æ•°curryåŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é˜²ç¯¡æ”¹å¯¹è±¡"><span class="toc-number">2.</span> <span class="toc-text">é˜²ç¯¡æ”¹å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸å¯æ‰©å±•å¯¹è±¡"><span class="toc-number">2.1.</span> <span class="toc-text">ä¸å¯æ‰©å±•å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯†å°çš„å¯¹è±¡"><span class="toc-number">2.2.</span> <span class="toc-text">å¯†å°çš„å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å†»ç»“çš„å¯¹è±¡"><span class="toc-number">2.3.</span> <span class="toc-text">å†»ç»“çš„å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é«˜çº§å®šæ—¶å™¨"><span class="toc-number">3.</span> <span class="toc-text">é«˜çº§å®šæ—¶å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é‡å¤çš„å®šæ—¶å™¨"><span class="toc-number">3.1.</span> <span class="toc-text">é‡å¤çš„å®šæ—¶å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yielding-processes"><span class="toc-number">3.2.</span> <span class="toc-text">yielding processes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‡½æ•°èŠ‚æµ"><span class="toc-number">3.3.</span> <span class="toc-text">å‡½æ•°èŠ‚æµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è‡ªå®šä¹‰äº‹ä»¶"><span class="toc-number">4.</span> <span class="toc-text">è‡ªå®šä¹‰äº‹ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ‹–æ”¾"><span class="toc-number">5.</span> <span class="toc-text">æ‹–æ”¾</span></a></li></ol>
    </div>
    
    <h2 id="é«˜çº§å‡½æ•°"><a href="#é«˜çº§å‡½æ•°" class="headerlink" title="é«˜çº§å‡½æ•°"></a>é«˜çº§å‡½æ•°</h2><h3 id="å®‰å…¨ç±»å‹çš„æ£€æµ‹"><a href="#å®‰å…¨ç±»å‹çš„æ£€æµ‹" class="headerlink" title="å®‰å…¨ç±»å‹çš„æ£€æµ‹"></a>å®‰å…¨ç±»å‹çš„æ£€æµ‹</h3><p>JavaScript å†…ç½®çš„ç±»å‹æ£€æµ‹æœºåˆ¶å¹¶éå®Œå…¨å¯é ã€‚äº‹å®ä¸Šï¼Œå‘ç”Ÿé”™è¯¯å¦å®šåŠé”™è¯¯è‚¯å®šçš„æƒ…å†µä¹Ÿä¸åœ¨å°‘æ•°ã€‚æ¯”å¦‚è¯´ typeof æ“ä½œç¬¦å§ï¼Œç”±äºå®ƒæœ‰ä¸€äº›æ— æ³•é¢„çŸ¥çš„è¡Œä¸ºï¼Œç»å¸¸ä¼šå¯¼è‡´æ£€æµ‹æ•°æ®ç±»å‹æ—¶å¾—åˆ°ä¸é è°±çš„ç»“æœã€‚<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> isArray = value <span class="keyword">instanceof</span> <span class="built_in">Array</span>;</span><br></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªè¡¨è¾¾å¼è¦æ˜¯æƒ³è¿”å›trueï¼Œvalueå¿…é¡»æ˜¯ä¸ªæ•°ç»„ï¼Œä¸”å¿…é¡»ä¸Arrayæ„é€ å‡½æ•°åœ¨åŒä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå¦‚æœvalueæ˜¯å¦ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸ(å…¶ä»–frame)ä¸­å®šä¹‰çš„æ•°ç»„ï¼Œé‚£è¿™ä¸ªè¡¨è¾¾å¼è¿”å›falseã€‚</p>
<p>æ£€æµ‹æŸä¸ªå¯¹è±¡æ˜¯åŸç”Ÿçš„è¿˜æ˜¯å¼€å‘äººå‘˜è‡ªå®šä¹‰çš„å¯¹è±¡æ—¶ä¹Ÿä¼šæœ‰é—®é¢˜ã€‚å› ä¸ºæµè§ˆå™¨å¼€å§‹åŸç”Ÿæ”¯æŒJSONäº†ï¼Œè€Œæœ‰äº›å¼€å‘äººå‘˜è¿˜æ˜¯åœ¨ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ç°JSONï¼Œè¿™ä¸ªåº“é‡Œä¼šæœ‰å…¨å±€çš„JSONå¯¹è±¡ï¼Œè¿™æ ·æƒ³ç¡®å®šJSONå¯¹è±¡æ˜¯ä¸æ˜¯åŸç”Ÿçš„å°±éº»çƒ¦äº†ã€‚<br>è§£å†³è¿™äº›é—®é¢˜çš„åŠæ³•å°±æ˜¯ä½¿ç”¨Objectçš„toStringæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª[object NativeConstructorName]æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) == <span class="string">"[object Array]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFunction</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) == <span class="string">"[object Function]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isRegExp</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(value) == <span class="string">"[object RegExp]"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºåœ¨IEä¸­ä»»ä½•ä»¥COMå½¢å¼å®ç°çš„å‡½æ•°ï¼ŒisFunction()éƒ½ä¼šè¿”å›falseã€‚<br>å¯¹äºJSONæ˜¯å¦ä¸ºåŸç”Ÿçš„é—®é¢˜å¯ä»¥è¿™æ ·ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> isNativeJSON = <span class="built_in">window</span>.JSON &amp;&amp; <span class="built_in">Object</span>.prototype.toString.call(<span class="built_in">JSON</span>) == <span class="string">"[object JSON]"</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°"><a href="#ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°" class="headerlink" title="ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°"></a>ä½œç”¨åŸŸå®‰å…¨çš„æ„é€ å‡½æ•°</h3><p>ç¬¬å…­ç« çš„æ—¶å€™æˆ‘ä»¬å°†äº†æ„é€ å‡½æ•°, æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ä¸€ä¸ªä¾‹å­:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.job = job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸ä½¿ç”¨newè¿ç®—ç¬¦, é‚£ä¹ˆname, age, jobä¸‰ä¸ªå±æ€§ä¼šè¢«ç›´æ¥æŒ‚åœ¨åˆ°windowå¯¹è±¡ä¸Š, ä¸ºäº†é˜²æ­¢æ™®é€šè°ƒç”¨çš„è¿‡ç¨‹ä¸­å‡ºç°è¿™ç§ç–å¿½,  æˆ‘ä»¬æœ‰å¿…è¦åšä¸€é“ä¿é™©:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, job</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">instanceof</span> Person)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.job = job;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Person(name, age, job); <span class="comment">//ä¿é™©</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = Person(<span class="string">"Nicholas"</span>, <span class="number">29</span>, <span class="string">"Software Engineer"</span>);</span><br><span class="line">alert(<span class="built_in">window</span>.name);      <span class="comment">//""</span></span><br><span class="line">alert(person1.name);     <span class="comment">//"Nicholas"</span></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">"Shelby"</span>, <span class="number">34</span>, <span class="string">"Ergonomist"</span>);</span><br><span class="line">alert(person2.name);     <span class="comment">//"Shelby"</span></span><br></pre></td></tr></table></figure></p>
<p>åŠ äº†è¿™ä¸ªåˆ¤æ–­ä¹‹å,çœ‹èµ·æ¥æ›´å«ç¨³å¦¥.</p>
<p>ä¸è¿‡åˆäº§ç”Ÿäº†æ–°çš„é—®é¢˜, å‡å¦‚Personå‡½æ•°è°ƒç”¨call/applyå®ç°ç»§æ‰¿çš„è¯, é‚£ä¹ˆç»“æœå¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Polygon</span>(<span class="params">sides</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">instanceof</span> Polygon) &#123;</span><br><span class="line">        <span class="keyword">this</span>.sides = sides;</span><br><span class="line">        <span class="keyword">this</span>.getArea = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Polygon(sides);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>(<span class="params">width, height</span>)</span>&#123;</span><br><span class="line">    Polygon.call(<span class="keyword">this</span>, <span class="number">2</span>);	<span class="comment">//è¿™é‡Œçš„thisä¼ çš„æ˜¯Rectangleçš„å®ä¾‹</span></span><br><span class="line">    <span class="keyword">this</span>.width = width;</span><br><span class="line">    <span class="keyword">this</span>.height = height;</span><br><span class="line">    <span class="keyword">this</span>.getArea = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.width * <span class="keyword">this</span>.height;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> rect = <span class="keyword">new</span> Rectangle(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">alert(rect.sides);        <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure></p>
<p>è§£å†³æ–¹å¼:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Rectangle.prototype = <span class="keyword">new</span> Polygon();	<span class="comment">//åŸå‹é“¾ç»§æ‰¿, è¿™æ ·thiså°±æ˜¯Polygonçš„å®ä¾‹äº†</span></span><br><span class="line"><span class="keyword">var</span> rect = <span class="keyword">new</span> Rectangle(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">alert(rect.sides);        <span class="comment">//2</span></span><br></pre></td></tr></table></figure></p>
<h3 id="æƒ°æ€§è½½å…¥å‡½æ•°"><a href="#æƒ°æ€§è½½å…¥å‡½æ•°" class="headerlink" title="æƒ°æ€§è½½å…¥å‡½æ•°"></a>æƒ°æ€§è½½å…¥å‡½æ•°</h3><p>ç”±äºæµè§ˆå™¨å·®å¼‚ï¼Œå¤§é‡çš„åˆ¤æ–­æµè§ˆå™¨èƒ½åŠ›çš„å‡½æ•°éœ€è¦è¢«ä½¿ç”¨ï¼ˆé€šå¸¸æ˜¯å¤§é‡çš„ifï¼‰ï¼Œç„¶è€Œè¿™äº›åˆ¤æ–­ä¸€èˆ¬å…¶å®ä¸å¿…æ¯æ¬¡éƒ½æ‰§è¡Œï¼Œåœ¨æ‰§è¡Œä¸€æ¬¡åï¼Œæµè§ˆå™¨çš„èƒ½åŠ›å°±ç¡®å®šäº†ï¼Œä»¥åå°±åº”è¯¥ä¸ç”¨åœ¨åˆ¤æ–­äº†ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createXHR</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> XMLHttpRequest != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> ActiveXObject != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">arguments</span>.callee.activeXString != <span class="string">"string"</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> versions = [<span class="string">"MSXML2.XMLHttp.6.0"</span>, <span class="string">"MSXML2.XMLHttp.3.0"</span>,</span><br><span class="line">                    <span class="string">"MSXML2.XMLHttp"</span>],</span><br><span class="line">                i,len;</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">0</span>,len=versions.length; i &lt; len; i++)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">new</span> ActiveXObject(versions[i]);</span><br><span class="line">                    <span class="built_in">arguments</span>.callee.activeXString = versions[i];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ex)&#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="built_in">arguments</span>.callee.activeXString);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"No XHR object available."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œçš„åˆ›å»ºXHRå¯¹è±¡çš„å‡½æ•°ï¼Œæ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶éƒ½ä¼šåˆ¤æ–­ä¸€æ¬¡æµè§ˆå™¨èƒ½åŠ›ï¼Œè¿™æ˜¯ä¸å¿…è¦çš„ã€‚</p>
<p>æƒ°æ€§è½½å…¥æœ‰ä¸¤ç§æ–¹å¼. ç¬¬ä¸€ç§å°±æ˜¯åœ¨å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œæ ¹æ®ä¸åŒæƒ…å†µï¼Œç”¨ä¸åŒçš„æ–°å‡½æ•°æŠŠè¿™ä¸ªå‡½æ•°è¦†ç›–æ‰ï¼Œä»¥åè°ƒç”¨å°±ä¸éœ€è¦å†åˆ¤æ–­è€Œæ˜¯ç›´æ¥æ‰§è¡Œè¯¥æ‰§è¡Œçš„æ“ä½œã€‚<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createXHR</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> XMLHttpRequest != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        createXHR = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> ActiveXObject != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        createXHR = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">arguments</span>.callee.activeXString != <span class="string">"string"</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> versions = [<span class="string">"MSXML2.XMLHttp.6.0"</span>, <span class="string">"MSXML2.XMLHttp.3.0"</span>,</span><br><span class="line">                        <span class="string">"MSXML2.XMLHttp"</span>],</span><br><span class="line">                        i, len;</span><br><span class="line">                <span class="keyword">for</span> (i=<span class="number">0</span>,len=versions.length; i &lt; len; i++)&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">new</span> ActiveXObject(versions[i]);</span><br><span class="line">                        <span class="built_in">arguments</span>.callee.activeXString = versions[i];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (ex)&#123;</span><br><span class="line">                        <span class="comment">//skip</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="built_in">arguments</span>.callee.activeXString);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        createXHR = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"No XHR object available."</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> createXHR();</span><br><span class="line">&#125;</span><br><span class="line">createXHR();<span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ä¼šæ‰§è¡Œifè¯­å¥</span></span><br><span class="line">createXHR();<span class="comment">//ç¬¬äºŒæ¬¡å°±ä¸ä¼šæ‰§è¡Œifè¯­å¥äº†</span></span><br></pre></td></tr></table></figure></p>
<p>ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯åœ¨å£°æ˜å‡½æ•°æ—¶å€™å°±æŒ‡å®šé€‚å½“çš„å‡½æ•°, å®é™…ä¸ŠåŸç†å’Œä¸Šé¢çš„ç±»ä¼¼:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> createXHR = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> XMLHttpRequest != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> ActiveXObject != <span class="string">"undefined"</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">arguments</span>.callee.activeXString != <span class="string">"string"</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> versions = [<span class="string">"MSXML2.XMLHttp.6.0"</span>, <span class="string">"MSXML2.XMLHttp.3.0"</span>,</span><br><span class="line">                    <span class="string">"MSXML2.XMLHttp"</span>],</span><br><span class="line">                    i, len;</span><br><span class="line">                <span class="keyword">for</span> (i=<span class="number">0</span>,len=versions.length; i &lt; len; i++)&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">new</span> ActiveXObject(versions[i]);</span><br><span class="line">                        <span class="built_in">arguments</span>.callee.activeXString = versions[i];</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (ex)&#123;</span><br><span class="line">                        <span class="comment">//skip</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="built_in">arguments</span>.callee.activeXString);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"No XHR object available."</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();	<span class="comment">//è¿™é‡Œæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°, æ‰§è¡Œå®Œæ¯•åcreateXHRå°±å¯ä»¥ç›´æ¥è°ƒç”¨, æ— éœ€å†æ£€æµ‹</span></span><br></pre></td></tr></table></figure>
<h3 id="å‡½æ•°ç»‘å®š"><a href="#å‡½æ•°ç»‘å®š" class="headerlink" title="å‡½æ•°ç»‘å®š"></a>å‡½æ•°ç»‘å®š</h3><p>å‡½æ•°ç»‘å®šæ˜¯ä¸ºäº†è§£å†³thisçš„æŒ‡å‘é—®é¢˜ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> handler = &#123;</span><br><span class="line">      message: <span class="string">"Event handled"</span>,</span><br><span class="line">      handleClick: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.message);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"myButton"</span>);</span><br><span class="line"></span><br><span class="line">    btn.addEventListener(<span class="string">'click'</span>, handler.handleClick, <span class="literal">false</span>);	<span class="comment">//è¿™é‡Œä¼šè¾“å‡º dom å’Œ undefined, è¡¨é¢ä¸Šhandler.handleClickæ˜¯æŒ‚è½½åœ¨handlerä¸Š, ä½†æ˜¯å®ƒé‡Œé¢çš„thisæŒ‡å‘ä¼šå‘ç”Ÿæ”¹å˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜, æˆ‘ä»¬æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•1: æ–°å¢åŒ¿åå‡½æ•°</span></span><br><span class="line">    btn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>)</span>&#123;</span><br><span class="line">      handler.handleClick(evt)	<span class="comment">// é€šè¿‡æ–°å¢ä¸€ä¸ªåŒ¿åå‡½æ•°å¯ä»¥å®æœŸå¾…çš„è¾“å‡º</span></span><br><span class="line">    &#125;, <span class="literal">false</span>); </span><br><span class="line"><span class="comment">// æ–¹æ³•2: ä½¿ç”¨Es5 bindæ–¹æ³•</span></span><br><span class="line">btn.addEventListener(<span class="string">'click'</span>, handler.handleClick.bind(handler), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒbindæ–¹æ³•, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨applyå®ç°ä¸€ä¸ª</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">Function</span>.prototype.bind)&#123;</span><br><span class="line">  <span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params">fn,context</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      fn.apply(context,<span class="built_in">arguments</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="å‡½æ•°curryåŒ–"><a href="#å‡½æ•°curryåŒ–" class="headerlink" title="å‡½æ•°curryåŒ–"></a>å‡½æ•°curryåŒ–</h3><p>å‡½æ•°curryåŒ–, ä¸­æ–‡ç¿»è¯‘æŸ¯é‡ŒåŒ–, ä¸ªäººè§‰å¾—åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸æ˜¯å¾ˆæœ‰å¿…è¦.ä¹¦ä¸Šè®²å¾—ä¹Ÿä¸å¥½, è¯·ç›´æ¥è§‚çœ‹ <a href="https://www.jianshu.com/p/9b6b5c7527fc" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>è®²è§£ä»€ä¹ˆæ˜¯curryåŒ– </p>
<h2 id="é˜²ç¯¡æ”¹å¯¹è±¡"><a href="#é˜²ç¯¡æ”¹å¯¹è±¡" class="headerlink" title="é˜²ç¯¡æ”¹å¯¹è±¡"></a>é˜²ç¯¡æ”¹å¯¹è±¡</h2><h3 id="ä¸å¯æ‰©å±•å¯¹è±¡"><a href="#ä¸å¯æ‰©å±•å¯¹è±¡" class="headerlink" title="ä¸å¯æ‰©å±•å¯¹è±¡"></a>ä¸å¯æ‰©å±•å¯¹è±¡</h3><p>JSå…±äº«çš„æœ¬è´¨ä½¿ä»»æ„å¯¹è±¡éƒ½å¯è¢«éšæ„ä¿®æ”¹ã€‚è¿™æ ·æœ‰æ—¶å¾ˆä¸æ–¹ä¾¿ã€‚ES5å¢åŠ äº†å‡ ä¸ªæ–¹æ³•æ¥è®¾ç½®å¯¹è±¡çš„è¡Œä¸ºã€‚ä¸€æ—¦å°†å¯¹è±¡è®¾ç½®ä¸ºé˜²ç¯¡æ”¹å°±ä¸èƒ½æ’¤é”€äº†ã€‚<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123; <span class="attr">name</span>: <span class="string">"Nicholas"</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.preventExtensions(person);		<span class="comment">//ES5æ–°å¢çš„Object.preventExtensionsæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">person.age = <span class="number">29</span>;</span><br><span class="line">alert(person.age); <span class="comment">//undefined</span></span><br><span class="line">alert(<span class="built_in">Object</span>.isExtensible(person)); <span class="comment">//false</span></span><br><span class="line">person.name = <span class="string">"hahah"</span>;	<span class="comment">//å¯ä»¥å¯¹ç°æœ‰å±æ€§è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">alert(person.name); <span class="comment">//hahah</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å¯†å°çš„å¯¹è±¡"><a href="#å¯†å°çš„å¯¹è±¡" class="headerlink" title="å¯†å°çš„å¯¹è±¡"></a>å¯†å°çš„å¯¹è±¡</h3><p>å¯†å°å¯¹è±¡æ¯”ä¸å¯æ‰©å±•å¯¹è±¡æ›´åŠ ä¸¥æ ¼, å®ƒä¸å¯ä»¥æ·»åŠ æˆ–åˆ é™¤å±æ€§ï¼Œå·²æœ‰æˆå‘˜çš„[[Configurable]]ç‰¹æ€§è¢«è®¾ç½®ä¸ºfalseã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123; <span class="attr">name</span>: <span class="string">"Nicholas"</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.seal(person);</span><br><span class="line"></span><br><span class="line">person.age = <span class="number">29</span>; </span><br><span class="line">alert(person.age); <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> person.name; 	<span class="comment">//ä¸èƒ½åˆ é™¤</span></span><br><span class="line">alert(person.name); <span class="comment">//"Nicholas"</span></span><br><span class="line"></span><br><span class="line">alert(<span class="built_in">Object</span>.isExtensible(person)); <span class="comment">//false ,ä¸èƒ½æ‰©å±•</span></span><br><span class="line">alert(<span class="built_in">Object</span>.isSealed(person));     <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<h3 id="å†»ç»“çš„å¯¹è±¡"><a href="#å†»ç»“çš„å¯¹è±¡" class="headerlink" title="å†»ç»“çš„å¯¹è±¡"></a>å†»ç»“çš„å¯¹è±¡</h3><p>Object.freeze, æ¯”å‰é¢ä¸¤ä¸ªæ›´åŠ ä¸¥æ ¼<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123; <span class="attr">name</span>: <span class="string">"Nicholas"</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.freeze(person);</span><br><span class="line">person.age = <span class="number">29</span>; </span><br><span class="line">alert(person.age); <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> person.name; </span><br><span class="line">alert(person.name); <span class="comment">//"Nicholas"</span></span><br><span class="line"></span><br><span class="line">person.name = <span class="string">"Greg"</span>; </span><br><span class="line">alert(person.name); <span class="comment">//"Nicholas"</span></span><br><span class="line"></span><br><span class="line">alert(<span class="built_in">Object</span>.isExtensible(person));<span class="comment">//false</span></span><br><span class="line">alert(<span class="built_in">Object</span>.isSealed(person));<span class="comment">//true</span></span><br><span class="line">alert(<span class="built_in">Object</span>.isFrozen(person));<span class="comment">//true</span></span><br></pre></td></tr></table></figure></p>
<h2 id="é«˜çº§å®šæ—¶å™¨"><a href="#é«˜çº§å®šæ—¶å™¨" class="headerlink" title="é«˜çº§å®šæ—¶å™¨"></a>é«˜çº§å®šæ—¶å™¨</h2><p>setTimeout()å’ŒsetInterval()æ˜¯å¾ˆå®ç”¨çš„åŠŸèƒ½ï¼Œä¸è¿‡æœ‰äº›äº‹æƒ…æ˜¯è¦æ³¨æ„çš„ã€‚<br>JSæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿™å°±æ„å‘³ç€å®šæ—¶å™¨å®é™…ä¸Šæ˜¯å¾ˆæœ‰å¯èƒ½è¢«é˜»å¡çš„ã€‚æˆ‘ä»¬åœ¨è¿™ä¸¤ä¸ªå‡½æ•°ä¸­æ‰€è®¾ç½®çš„å®šæ—¶ï¼Œå…¶å®æ˜¯ä»£è¡¨å°†ä»£ç åŠ å…¥åˆ°æ‰§è¡Œé˜Ÿåˆ—çš„äº‹ä»¶ï¼Œå¦‚æœåœ¨åŠ å…¥æ—¶æ°å·§JSæ˜¯ç©ºé—²çš„ï¼Œé‚£ä¹ˆè¿™æ®µä»£ç ä¼šç«‹å³è¢«æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªå®šæ—¶è¢«å‡†æ—¶çš„æ‰§è¡Œäº†ã€‚ç›¸åï¼Œå¦‚æœè¿™æ—¶JSå¹¶ä¸ç©ºé—²æˆ–é˜Ÿåˆ—ä¸­è¿˜æœ‰åˆ«çš„ä¼˜å…ˆçº§æ›´é«˜çš„ä»£ç ï¼Œé‚£å°±æ„å‘³ç€ä½ çš„å®šæ—¶å™¨ä¼šè¢«å»¶æ—¶æ‰§è¡Œã€‚</p>
<blockquote>
<p>è®°ä½: åœ¨JSä¸­, æ²¡æœ‰ä»»ä½•ä»£ç æ˜¯ç«‹å³æ‰§è¡Œçš„, åªæœ‰ä¸€æ—¦è¿›ç¨‹ç©ºé—²å°±æ‰§è¡Œ.</p>
</blockquote>
<h3 id="é‡å¤çš„å®šæ—¶å™¨"><a href="#é‡å¤çš„å®šæ—¶å™¨" class="headerlink" title="é‡å¤çš„å®šæ—¶å™¨"></a>é‡å¤çš„å®šæ—¶å™¨</h3><p>ä½¿ç”¨setIntervalåˆ›å»ºå®šæ—¶å™¨çš„ç›®çš„æ˜¯ä½¿ä»£ç è§„åˆ™çš„æ’å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚è¿™ä¸ªæ–¹å¼çš„é—®é¢˜åœ¨äºï¼Œå­˜åœ¨è¿™æ ·ä¸€ç§å¯èƒ½ï¼Œåœ¨ä¸Šæ¬¡ä»£ç è¿˜æ²¡æ‰§è¡Œå®Œçš„æ—¶å€™ä»£ç å†æ¬¡è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ã€‚JSå¼•æ“ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨å°†ä»£ç æ·»åŠ åˆ°é˜Ÿåˆ—æ—¶ä¼šæ£€æŸ¥é˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰ä»£ç å®ä¾‹ï¼Œå¦‚æœæœ‰å°±ä¸æ·»åŠ ï¼Œè¿™ç¡®ä¿äº†å®šæ—¶å™¨ä»£ç è¢«åŠ å…¥é˜Ÿåˆ—ä¸­çš„æœ€å°é—´éš”æ˜¯è§„å®šé—´éš”ã€‚ä½†æ˜¯åœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹è¿˜æ˜¯ä¼šå‡ºç°ä¸¤ä¸ªé—®é¢˜ï¼ŒæŸäº›é—´éš”å› ä¸ºJSçš„å¤„ç†è¢«è·³è¿‡ï¼Œä»£ç ä¹‹é—´çš„é—´éš”æ¯”é¢„æœŸçš„å°ã€‚<br>æ‰€ä»¥å°½é‡ä½¿ç”¨setTimeout()æ¨¡æ‹Ÿé—´éš”è°ƒç”¨ã€‚<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    setTimeout(<span class="built_in">arguments</span>.callee, interval);</span><br><span class="line">&#125;, interval);</span><br></pre></td></tr></table></figure></p>
<h3 id="yielding-processes"><a href="#yielding-processes" class="headerlink" title="yielding processes"></a>yielding processes</h3><p>æµè§ˆå™¨ä¸­çš„jsè¢«åˆ†é…äº†ä¸€ä¸ªç¡®å®šæ•°é‡çš„èµ„æºï¼Œæ‰€ä»¥ä¼šé™åˆ¶jsè„šæœ¬çš„è¿è¡Œæ—¶é—´ï¼Œä¸èƒ½è¿‡é•¿ã€‚</p>
<p>å¦‚æœè¾¾åˆ°è¿™ä¸ªé™åˆ¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªæµè§ˆå™¨é”™è¯¯çš„å¯¹è¯æ¡†ï¼Œè¯¢é—®æ˜¯å¦ç»§ç»­æ‰§è¡Œã€‚å®šæ—¶å™¨æ—¶ç»•å¼€æ­¤é™åˆ¶çš„æ–¹æ³•ä¹‹ä¸€ã€‚</p>
<p>è„šæœ¬é•¿æ—¶é—´è¿è¡Œçš„åŸå› æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>è¿‡é•¿çš„ã€è¿‡æ·±åµŒå¥—çš„å‡½æ•°è°ƒç”¨</li>
<li>è¿›è¡Œå¤§é‡å¤„ç†çš„å¾ªç¯</li>
</ul>
<p>é€šå¸¸æˆ‘ä»¬æ˜¯å¤„ç†ç¬¬äºŒä¸ªå› ç´ , ä½†æ˜¯è¦è®°ä½, å¦‚æœä½ çš„å¾ªç¯ä¸å¿…<strong>åŒæ­¥</strong>,æˆ–è€…ç»“æœ<strong>ä¸å¿…æŒ‰é¡ºåº</strong>, é‚£ä¹ˆä¹ˆå°±å¯ä»¥é‡‡ç”¨yielding processesæ€æƒ³.</p>
<p>æˆ‘ä»¬çœ‹è¿™ä¾‹å­:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chunk</span>(<span class="params">array, process, context</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> item = array.shift();</span><br><span class="line">        process.call(context, item);</span><br><span class="line">        <span class="keyword">if</span> (array.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            setTimeout(<span class="built_in">arguments</span>.callee, <span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> data = [<span class="number">12</span>,<span class="number">123</span>,<span class="number">1234</span>,<span class="number">453</span>,<span class="number">436</span>,<span class="number">23</span>,<span class="number">23</span>,<span class="number">5</span>,<span class="number">4123</span>,<span class="number">45</span>,<span class="number">346</span>,<span class="number">5634</span>,<span class="number">2234</span>,<span class="number">345</span>,<span class="number">342</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printValue</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">"myDiv"</span>);</span><br><span class="line">    div.innerHTML += item + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">chunk(data, printValue);</span><br></pre></td></tr></table></figure></p>
<h3 id="å‡½æ•°èŠ‚æµ"><a href="#å‡½æ•°èŠ‚æµ" class="headerlink" title="å‡½æ•°èŠ‚æµ"></a>å‡½æ•°èŠ‚æµ</h3><p>ä¸¾ä¸ªä¾‹å­ , é¡µé¢æœ‰ä¸€ä¸ªé•¿åº¦ä¸º3çš„è½®æ’­å›¾, ä½ é¼ æ ‡æ”¾åˆ°(hover)å¯¹åº”è½®æ’­ç‚¹çš„æ—¶å€™è‡ªåŠ¨æ˜¾ç¤ºè¯¥å¼ å›¾, å¦‚æœä½ åœ¨éå¸¸çŸ­æ—¶é—´(æ¯”å¦‚10ms)å†…å¿«é€Ÿæ¥å›hover, é‚£å›¾ç‰‡è‡ªç„¶ä¹Ÿä¼šä¹Ÿä¼šå¿«é€Ÿé—ªçƒ, è¿™æ ·ä¼šæ“ä½œæ€§èƒ½çš„æµªè´¹. æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨setTimeoutæ¥é™åˆ¶ç”¨æˆ·çš„hoveré¢‘ç‡</p>
<h2 id="è‡ªå®šä¹‰äº‹ä»¶"><a href="#è‡ªå®šä¹‰äº‹ä»¶" class="headerlink" title="è‡ªå®šä¹‰äº‹ä»¶"></a>è‡ªå®šä¹‰äº‹ä»¶</h2><p>äº‹ä»¶æ˜¯ä¸€ç§å«åšè§‚å¯Ÿè€…æ¨¡çš„è®¾è®¡æ¨¡å¼(ä¹Ÿå«å‘å¸ƒè®¢é˜…æ¨¡å¼), è¿™æ˜¯ä¸€ç§åˆ›å»ºæ¾æ•£è€¦åˆçš„ä»£ç æŠ€æœ¯.<br>è§‚å¯Ÿè€…æ¨¡å¼æœ‰ä¸¤ç±»å¯¹è±¡ç»„æˆ: ä¸»ä½“å’Œè§‚å¯Ÿè€…, ä¸»ä½“å‘å¸ƒæ—¶é—´, åŒæ—¶è§‚å¯Ÿè€…é€šè¿‡è®¢é˜…è¿™äº›äº‹ä»¶æ¥è§‚å¯Ÿä¸»ä½“. æ¶‰åŠåˆ°DOMä¸Š, DOMå…ƒç´ å°±æ˜¯ä¸»ä½“, ä½ çš„äº‹ä»¶å¤„ç†ç¨‹åºå°±æ˜¯è§‚å¯Ÿè€….</p>
<p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„è§‚å¯Ÿè€…æ¨¡å¼:<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Pubsub = <span class="function"><span class="keyword">function</span>  (<span class="params">argument</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.hub = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    Pubsub.prototype.on = <span class="function"><span class="keyword">function</span>(<span class="params">type,fn</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">this</span>.hub[type]) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hub[type] = [];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.hub[type].push(fn);</span><br><span class="line">    &#125;;</span><br><span class="line">    Pubsub.prototype.off = <span class="function"><span class="keyword">function</span>(<span class="params">type</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.hub[type] = [];</span><br><span class="line">    &#125;;</span><br><span class="line">    Pubsub.prototype.fire = <span class="function"><span class="keyword">function</span>(<span class="params">type,fn</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> fns  = <span class="keyword">this</span>.hub[type];  <span class="comment">//æœ‰å¯èƒ½å­˜äº†å¤šä¸ªäº‹ä»¶</span></span><br><span class="line">      <span class="keyword">if</span> (!fns.length) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'æ— '</span>+type+<span class="string">'è®¢é˜…'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; fns.length; i++) &#123;</span><br><span class="line">        fns[i]();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">new</span> Pubsub;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"I'm reading"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"I'm recording"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    user.on(<span class="string">'update'</span>,read);</span><br><span class="line">    user.on(<span class="string">'update'</span>,read2);</span><br><span class="line"></span><br><span class="line">    user.fire(<span class="string">'update'</span>);</span><br><span class="line"></span><br><span class="line">    user.off(<span class="string">'update'</span>);</span><br><span class="line">    user.fire(<span class="string">'update'</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="æ‹–æ”¾"><a href="#æ‹–æ”¾" class="headerlink" title="æ‹–æ”¾"></a>æ‹–æ”¾</h2><blockquote>
<p>ä¸å¤ªæ¸…é™¤ä¸ºä½•<code>æ‹–æ”¾</code>è¿™èŠ‚å†…å®¹ä¼šæ”¾åœ¨é«˜çº§æŠ€å·§ä¸­, è¿™é‡Œä¸å†è®²è§£.</p>
</blockquote>
<p>JSå®ç°æ‹–æ”¾çš„æ€è·¯å°±æ˜¯å¯¹ä¸€ä¸ªDOMå…ƒç´ è®¾ç½®ç»å¯¹å®šä½, ç„¶åæ ¹æ®é¼ æ ‡çš„ä½ç½®, é…åˆmouseDown/mouseUp/mouseMoveäº‹ä»¶æ¥åŠ¨æ€è®¾ç½®DOMå…ƒç´ çš„top/leftå€¼. ä»£ç ç•¥</p>
<hr>
<p>æœ¬ç« å®Œ</p>

  </div>

</article>


  <nav id="pagenavi">
    
    <a href="/2019/04/09/JSbook23/" class="prev">ä¸Šä¸€ç¯‡ï¼šJSçº¢çš®ä¹¦è¯»ä¹¦ç¬”è®°-23-ç¦»çº¿åº”ç”¨ä¸å®¢æˆ·ç«¯å­˜å‚¨</a>
    
    
    <a href="/2019/04/09/JSbook21/" class="next">ä¸‹ä¸€ç¯‡ï¼šJSçº¢çš®ä¹¦è¯»ä¹¦ç¬”è®°-21-Ajaxä¸Comet</a>
    
  </nav>

        </div>
        
        
          <div class="post-comments" id="Jcmt">
            <h1 class="post-comments-title">è®¿å®¢è¯„è®º</h1>
            <div id="Jcomment"></div>
          </div>
        
      </div>
      <footer id="footer" class="inner">
        Â© 2021 - æµ‹è¯•ç‹— -
        <span id="busuanzi_container_site_pv">PV <span id="busuanzi_value_site_pv"></span></span>
        <p>Powered by <a href="https://hexo.io/">Hexo</a> & <a href="https://github.com/thinkerchan/hexo-theme-greyshade">GreyShade</a></p>
      </footer>
    </div>
  </div>
  
  <script>
    let mod ={
      timePrefix:'t-',
      expire:1000*60*60,
      load:function(libName,libUrl,cb){
        let aval = (new Date).getTime() - localStorage.getItem(this.timePrefix+libName) < this.expire;
        let libStr = localStorage.getItem(libName)
        if (aval && libStr) {
          this.parseAndInsert(libStr)
          cb && cb(libStr);
        }else{
          this.ajax(libUrl,(str)=>{
            localStorage.setItem(libName, str)
            localStorage.setItem(this.timePrefix+libName, (new Date).getTime())
            this.parseAndInsert(str)
            cb && cb(str);
          })
        }
      },
      parseAndInsert(rawStr) {
        let script = document.createElement('script')
        script.innerHTML = rawStr
        document.body.appendChild(script)
      },
      ajax:function(url,cb){
        let xhr = new XMLHttpRequest;
        xhr.open('get', url, true)
        xhr.send();
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            cb && cb(xhr.responseText)
          }else{
            // console.log(xhr.readyState,xhr.status);
          }
        }
      },
      genCmt(){
        window.Valine && new Valine({
          el: '#Jcomment',
          appId: 'XPJzs0FfufkFfuBjbJraqhbo-gzGzoHsz',
          appKey: 'QoS0zL4Y2xTDviitGOPkvCGv',
          notify: true,
          verify: false,
          avatar: 'mm',
          pageSize: '10',
          placeholder: 'Valine+Leancloudæä¾›è¯„è®º'
        })
      }
    }

    mod.load('lib-av', 'https://cdn.jsdelivr.net/npm/leancloud-storage@3.0.1/dist/av-min.js', () => {
      mod.load('lib-cmt', 'https://unpkg.com/valine@1.4.14/dist/Valine.min.js',()=>{
        let t = setTimeout(() => {
          mod.genCmt()
          clearTimeout(t)
          t = null;
        }, 100);
      })
    })
  </script>
  
  <script async defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <script async defer src="https://s5.cnzz.com/z_stat.php?id=1276809529&web_id=1276809529"></script>
  
</body>
</html>